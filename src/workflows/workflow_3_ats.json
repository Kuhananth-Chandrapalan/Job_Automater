{
    "nodes": [
        {
            "name": "Cron (ATS)",
            "type": "n8n-nodes-base.cron",
            "parameters": {
                "mode": "everyX",
                "value": 30,
                "unit": "minutes"
            }
        },
        {
            "name": "Get Unscored Jobs",
            "type": "n8n-nodes-base.googleSheets",
            "parameters": {
                "operation": "read",
                "sheetId": "YOUR_SHEET_ID",
                "range": "A:T",
                "filters": {
                    "status": [
                        "New"
                    ]
                }
            }
        },
        {
            "name": "Get Master Resume",
            "type": "n8n-nodes-base.googleDocs",
            "parameters": {
                "operation": "get",
                "documentId": "YOUR_MASTER_RESUME_DOC_ID",
                "rawOutput": true
            }
        },
        {
            "name": "Score Job (API)",
            "type": "n8n-nodes-base.httpRequest",
            "parameters": {
                "url": "http://host.docker.internal:8000/score",
                "method": "POST",
                "bodyParametersUi": {
                    "parameter": [
                        {
                            "name": "job_description",
                            "value": "={{ $node[\"Get Unscored Jobs\"].json[\"description\"] }}"
                        },
                        {
                            "name": "role_title",
                            "value": "={{ $node[\"Get Unscored Jobs\"].json[\"role_title\"] }}"
                        },
                        {
                            "name": "resume_text",
                            "value": "={{ $node[\"Get Master Resume\"].json[\"content\"] }}"
                        }
                    ]
                }
            }
        },
        {
            "name": "Filter Logic",
            "type": "n8n-nodes-base.switch",
            "parameters": {
                "rules": {
                    "number": [
                        {
                            "value1": "={{ $json[\"score\"] }}",
                            "operation": "largerEqual",
                            "value2": 0.85
                        },
                        {
                            "value1": "={{ $json[\"score\"] }}",
                            "operation": "largerEqual",
                            "value2": 0.70
                        }
                    ]
                }
            }
        },
        {
            "name": "Update Ready",
            "type": "n8n-nodes-base.googleSheets",
            "parameters": {
                "operation": "update",
                "sheetId": "YOUR_SHEET_ID",
                "columnToMatchOn": "job_id",
                "fieldsUi": {
                    "parameter": [
                        {
                            "name": "status",
                            "value": "Ready (Email)"
                        },
                        {
                            "name": "ats_score",
                            "value": "={{ $json[\"score\"] }}"
                        }
                    ]
                }
            }
        },
        {
            "name": "Update Tailoring",
            "type": "n8n-nodes-base.googleSheets",
            "parameters": {
                "operation": "update",
                "sheetId": "YOUR_SHEET_ID",
                "columnToMatchOn": "job_id",
                "fieldsUi": {
                    "parameter": [
                        {
                            "name": "status",
                            "value": "Tailoring"
                        },
                        {
                            "name": "ats_score",
                            "value": "={{ $json[\"score\"] }}"
                        }
                    ]
                }
            }
        }
    ],
    "connections": {
        "Cron (ATS)": {
            "main": [
                [
                    {
                        "node": "Get Unscored Jobs",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Unscored Jobs": {
            "main": [
                [
                    {
                        "node": "Get Master Resume",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Get Master Resume": {
            "main": [
                [
                    {
                        "node": "Score Job (API)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Score Job (API)": {
            "main": [
                [
                    {
                        "node": "Filter Logic",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Filter Logic": {
            "main": [
                [
                    {
                        "node": "Update Ready",
                        "type": "main",
                        "index": 0
                    }
                ],
                [
                    {
                        "node": "Update Tailoring",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    }
}